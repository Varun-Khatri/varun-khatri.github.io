<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experience | Varun Khatri</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        /* Add form message styling if not in your CSS */
        .form-message {
            margin-top: 15px;
            padding: 12px 15px;
            border-radius: 6px;
            font-size: 14px;
            display: none;
        }

        .form-message.success {
            display: block;
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .form-message.error {
            display: block;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>

<body>
    <!-- NAV -->
    <nav class="navbar">
        <div class="container">
            <a href="./index.html" class="logo">
                VK<span>.</span>
            </a>
            <ul class="nav-links">
                <li><a href="./index.html">Home</a></li>
                <li><a href="./portfolio.html">Work</a></li>
                <li><a href="./about.html" class="active">Experience</a></li>
                <li><a href="./contact.html">Contact</a></li>
                <li><a href="./blog/index.html">Blog</a></li>
            </ul>
            <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- HERO -->
    <section class="hero experience-hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Professional Experience</h1>
                <p class="hero-description">
                    Senior Unity Developer and Technical Artist with 10+ years of experience delivering
                    performance-critical systems, rendering pipelines, and scalable game architectures
                    across mobile and VR platforms.
                </p>
                <div class="hero-buttons">
                    <a href="./downloads/Varun Khatri - Resumé.pdf" class="btn btn-primary" download>
                        <i class="fas fa-download"></i>
                        Download Resume
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- EXPERIENCE TIMELINE -->
    <section class="experience">
        <div class="container">
            <div class="timeline">

                <!-- RETINAD / HIGHSTREET -->
                <div class="timeline-item">
                    <div class="timeline-date">Feb 2022 –<br>Sep 2025</div>
                    <div class="timeline-content">
                        <h3>Senior Unity Developer / Technical Artist</h3>
                        <span class="company">Retinad Virtual Reality Inc</span>
                        <p>Toronto, Canada (Remote)</p>

                        <ul>
                            <li>Owned rendering, shader, and VFX pipelines across large-scale VR environments,
                                ensuring visual fidelity while meeting strict performance targets.</li>
                            <li>Led R&D initiatives for custom lighting models, day/night systems,
                                environment effects, and optimization strategies later adopted into production.</li>
                            <li>Designed and implemented avatar, apparel, and environment systems,
                                integrating third-party pipelines such as Ready Player Me.</li>
                            <li>Established graphics optimization workflows including LOD strategy,
                                occlusion culling, GPU/CPU profiling, and memory analysis.</li>
                        </ul>

                        <div class="project-tech timeline-tech">
                            <span>Unity</span>
                            <span>VR</span>
                            <span>Custom Shaders</span>
                            <span>VFX Graph</span>
                            <span>Optimization</span>
                            <span>R&D</span>
                        </div>
                    </div>
                </div>

                <!-- NEXTWAVE -->
                <div class="timeline-item">
                    <div class="timeline-date">Aug 2016 –<br>Nov 2021</div>
                    <div class="timeline-content">
                        <h3>Senior Game Developer</h3>
                        <span class="company">Nextwave Multimedia</span>
                        <p>Chennai, India</p>

                        <ul>
                            <li>Key technical contributor across the World Cricket Championship franchise
                                (100M+ downloads), owning graphics systems, shaders, VFX, and camera architecture.</li>
                            <li>Architected dynamic tournament and UI systems driven by server-side configuration,
                                leveraging Addressables for scalable live content delivery.</li>
                            <li>Reduced draw calls and material counts through custom shader solutions,
                                significantly improving performance on low-end mobile devices.</li>
                            <li>Led graphics performance analysis and optimization across multiple shipped titles.</li>
                        </ul>

                        <div class="project-tech timeline-tech">
                            <span>Unity</span>
                            <span>Mobile</span>
                            <span>Shaders</span>
                            <span>VFX</span>
                            <span>Addressables</span>
                            <span>Live Ops</span>
                        </div>
                    </div>
                </div>

                <!-- QNEURO -->
                <div class="timeline-item">
                    <div class="timeline-date">Jan 2016 –<br>Jul 2016</div>
                    <div class="timeline-content">
                        <h3>Game Programmer</h3>
                        <span class="company">Qneuro</span>
                        <p>Chennai, India</p>

                        <ul>
                            <li>Developed experimental educational games interfacing with EEG-based brain
                                activity monitoring headsets.</li>
                            <li>Architected low-latency data pipelines between Unity applications and
                                neuroheadset APIs to support real-time feedback loops.</li>
                            <li>Collaborated with neuroscientists and data analysts to translate
                                cognitive performance metrics into adaptive gameplay mechanics.</li>
                        </ul>

                        <div class="project-tech timeline-tech">
                            <span>Unity</span>
                            <span>Real-Time Data</span>
                            <span>API Integration</span>
                            <span>Educational</span>
                        </div>
                    </div>
                </div>

                <!-- VALARI -->
                <div class="timeline-item">
                    <div class="timeline-date">Aug 2014 –<br>Oct 2015</div>
                    <div class="timeline-content">
                        <h3>Game Programmer</h3>
                        <span class="company">Valari Studios</span>
                        <p>Chennai, India</p>

                        <ul>
                            <li>Delivered multiple Unity-based client projects across mobile, AR,
                                visualization, and interactive installations.</li>
                            <li>Led full-cycle development of <em>Goats or Tigers</em>,
                                from initial concept through App Store release.</li>
                            <li>Built interactive AR, architectural visualization,
                                and product showcase applications for enterprise clients.</li>
                        </ul>

                        <div class="project-tech timeline-tech">
                            <span>Unity</span>
                            <span>Mobile</span>
                            <span>AR</span>
                            <span>Client Projects</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- SKILLS -->
    <section class="skills expertise-section">
        <div class="container">
            <h2>Core Expertise</h2>
            <div class="skills-grid">
                <div class="skill-card">
                    <h3>Game & XR Development</h3>
                    <ul class="skill-list">
                        <li>Unity Engine</li>
                        <li>Mobile & VR Development</li>
                        <li>Gameplay & Systems Programming</li>
                        <li>Procedural Generation</li>
                    </ul>
                </div>

                <div class="skill-card">
                    <h3>Rendering & Technical Art</h3>
                    <ul class="skill-list">
                        <li>Custom Shaders (HLSL)</li>
                        <li>Shader Graph & VFX Graph</li>
                        <li>URP / HDRP</li>
                        <li>Graphics Optimization</li>
                    </ul>
                </div>

                <div class="skill-card">
                    <h3>Systems & Architecture</h3>
                    <ul class="skill-list">
                        <li>Addressables & Asset Pipelines</li>
                        <li>Chunk-Based World Loading</li>
                        <li>Data-Oriented Design</li>
                        <li>Custom Editor Tooling</li>
                    </ul>
                </div>

                <div class="skill-card">
                    <h3>Tools</h3>
                    <ul class="skill-list">
                        <li>Unity</li>
                        <li>Git</li>
                        <li>Blender</li>
                        <li>Photoshop</li>
                        <li>FMOD</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACT -->
    <section class="contact contact-prompt-section">
        <div class="container">
            <div class="contact-grid">
                <div class="contact-info">
                    <h2>Get In Touch</h2>
                    <p>
                        Open to senior engineering, technical art, and graphics-focused roles.
                        Happy to discuss complex systems, performance challenges, or new opportunities.
                    </p>

                    <div class="contact-details">
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fas fa-envelope"></i></div>
                            <div class="contact-text">
                                <h4>Email</h4>
                                <p>varun.khatri18@gmail.com</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
                            <div class="contact-text">
                                <h4>Location</h4>
                                <p>Halifax, NS, Canada</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="contact-form">
                    <h3>Send a Message</h3>
                    <form id="experienceContactForm">
                        <div class="form-group">
                            <label for="exp-name">Name</label>
                            <input type="text" id="exp-name" required>
                        </div>
                        <div class="form-group">
                            <label for="exp-email">Email</label>
                            <input type="email" id="exp-email" required>
                        </div>
                        <div class="form-group">
                            <label for="exp-message">Message</label>
                            <textarea id="exp-message" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full-width">Send Message</button>
                    </form>
                    <!-- Add message container for form feedback -->
                    <div id="experienceFormMessage" class="form-message"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    Varun Khatri<span>.</span>
                </div>
                <div class="footer-links">
                    <a href="./index.html">Home</a>
                    <a href="./portfolio.html">Work</a>
                    <a href="./about.html">Experience</a>
                    <a href="./contact.html">Contact</a>
                    <a href="./blog/index.html">Blog</a>
                </div>
                <div class="footer-social">
                    <a href="https://github.com/Varun-Khatri"><i class="fab fa-github"></i></a>
                    <a href="https://www.linkedin.com/in/varun-khatri-79b9a674/"><i class="fab fa-linkedin"></i></a>
                    <a href="mailto:varun.khatri18@gmail.com"><i class="fas fa-envelope"></i></a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Varun Khatri. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        document.querySelector('.menu-toggle').addEventListener('click', function () {
            document.querySelector('.nav-links').classList.toggle('active');
            this.querySelector('i').classList.toggle('fa-bars');
            this.querySelector('i').classList.toggle('fa-times');
        });

        // Close menu when clicking outside
        document.addEventListener('click', function (event) {
            const nav = document.querySelector('.nav-links');
            const toggle = document.querySelector('.menu-toggle');
            if (!nav.contains(event.target) && !toggle.contains(event.target)) {
                nav.classList.remove('active');
                toggle.querySelector('i').classList.add('fa-bars');
                toggle.querySelector('i').classList.remove('fa-times');
            }
        });

        // Contact form submission - JSONP version to handle CORS
        document.getElementById('experienceContactForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            submitBtn.disabled = true;

            // Prepare form data - using correct field IDs for about.html
            const formData = {
                name: document.getElementById('exp-name').value,
                email: document.getElementById('exp-email').value,
                message: document.getElementById('exp-message').value,
                sourcePage: 'experience'  // Different source page identifier
            };

            // YOUR Apps Script Web App URL (same as contact page)
            const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzj4rC-dpmnWjSrRlxvNhAMhxL2FzX6A6agQlFJAo9dQhJv53C22P3HrGAL1cILPbF7/exec';

            // Generate unique callback name for each submission
            const callbackName = 'experienceCallback_' + Date.now();

            try {
                // JSONP technique (bypasses CORS)
                const jsonpUrl = `${APPS_SCRIPT_URL}?callback=${callbackName}&data=${encodeURIComponent(JSON.stringify(formData))}`;

                // Create a promise for the JSONP request
                const jsonpPromise = new Promise((resolve, reject) => {
                    // Set up the callback function
                    window[callbackName] = function (response) {
                        // Clean up
                        if (script.parentNode) {
                            document.head.removeChild(script);
                        }
                        delete window[callbackName];

                        if (timeoutId) clearTimeout(timeoutId);

                        if (response && response.error) {
                            reject(new Error(response.message || 'Submission failed'));
                        } else {
                            resolve(response);
                        }
                    };

                    // Create and append script tag
                    const script = document.createElement('script');
                    script.src = jsonpUrl;

                    // Set timeout (10 seconds)
                    const timeoutId = setTimeout(() => {
                        if (script.parentNode) {
                            document.head.removeChild(script);
                        }
                        delete window[callbackName];
                        reject(new Error('Request timeout - please try again'));
                    }, 10000);

                    // Handle script errors
                    script.onerror = function () {
                        if (script.parentNode) {
                            document.head.removeChild(script);
                        }
                        delete window[callbackName];
                        if (timeoutId) clearTimeout(timeoutId);
                        reject(new Error('Network error - cannot connect to server'));
                    };

                    document.head.appendChild(script);
                });

                // Wait for the JSONP response
                const result = await jsonpPromise;

                // Success
                showExperienceMessage('Thank you for your message! I will get back to you soon.', 'success');
                this.reset();

            } catch (error) {
                console.error('Submission error:', error);
                showExperienceMessage('Sorry, there was an error: ' + error.message, 'error');
            } finally {
                // Restore button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        // Function to show status messages for experience page
        function showExperienceMessage(text, type) {
            const messageElement = document.getElementById('experienceFormMessage');
            messageElement.textContent = text;
            messageElement.className = 'form-message ' + type;

            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(() => {
                    messageElement.textContent = '';
                    messageElement.className = 'form-message';
                }, 5000);
            }
        }
    </script>
</body>

</html>